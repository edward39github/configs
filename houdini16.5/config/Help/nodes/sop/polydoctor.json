{"body": [{"indent": 0, "text": ["PolyDoctor"], "type": "title", "level": 0}, {"indent": 0, "type": "summary", "text": ["Helps repair invalid polygonal geometry, such as for cloth simulation."]}, {"indent": 0, "type": "para", "text": ["You can use this node to set attributes and optionally group invalid geometry,\nas well as attempt to automatically repair certain problems."]}, {"body": [{"body": [{"indent": 4, "type": "para", "text": ["This node only works on polygonal geometry. It ignores other types of input."]}], "indent": 0, "role": "item", "type": "note"}], "container": true, "role": "item_group", "type": "note_group"}, {"body": [{"indent": 0, "type": "para", "text": ["For each type of problem on the ", {"text": ["Primitives"], "type": "ui"}, " and ", {"text": ["Edges & Points"], "type": "ui"}, " tabs, you can choose one of three options: \"Ignore\", \"Mark\", or \"Repair\"."]}, {"body": [{"body": [{"indent": 4, "type": "para", "text": ["Geometry with this problem will have the \"valid\" attribute set to ", {"text": ["1"], "type": "code"}, " and\n    be included in the \"valid\" group."]}], "indent": 0, "type": "dt", "text": ["Ignore"]}, {"body": [{"indent": 4, "type": "para", "text": ["Geometry with this problem will have the \"valid\" attribute set to ", {"text": ["0"], "type": "code"}, " and\n    ", {"text": ["not"], "type": "strong"}, " be included in the \"valid\" group."]}], "indent": 0, "type": "dt", "text": ["Mark"]}, {"body": [{"indent": 4, "type": "para", "text": ["The node will attempt to automatically repair geometry with this problem.\n    Repaired polygons will have the \"valid\" and \"repaired\" attributes set to ", {"text": ["1"], "type": "code"}, " and be included in the \"valid\" and \"repaired\" groups."]}], "indent": 0, "type": "dt", "text": ["Repair"]}], "container": true, "type": "dt_group"}, {"indent": 0, "type": "para", "text": ["See the help for the ", {"text": ["Attributes"], "type": "ui"}, " tab below for the names of the \"valid\" and \"repaired\" attributes and groups."]}], "indent": 0, "level": 2, "text": ["Overview"], "container": true, "type": "h", "id": null}, {"body": [{"indent": 0, "type": "para", "text": ["Instead of or in addition to automatic repairs, you can use the attributes or groups created by this node with the \"Mark\" option to visualize problems and repair them manually."]}, {"body": [{"body": [{"body": [{"body": [{"indent": 8, "type": "para", "text": ["This creates a group named ", {"text": ["valid_poly_grp"], "type": "code"}, " containing the valid polygons (the polygons with the ", {"text": ["valid_poly"], "type": "code"}, " attribute set to ", {"text": ["1"], "type": "code"}, ")."]}, {"indent": 8, "type": "para", "text": ["Since you want to color the ", {"text": ["invalid"], "type": "em"}, " polygons, you\u2019ll need to create an inverted group from ", {"text": ["valid_poly_grp"], "type": "code"}, "."]}], "indent": 4, "blevel": 6, "type": "ord", "text": ["On the PolyDoctor node\u2019s ", {"text": ["Attributes"], "type": "ui"}, " tab, turn on ", {"text": ["Create a group for each attribute"], "type": "ui"}, "."]}, {"indent": 4, "blevel": 6, "type": "ord", "text": ["Right click the output of the PolyDoctor node and choose ", {"text": ["Group Geometry"], "fullpath": "/nodes/sop/group", "scheme": "Node", "type": "link", "value": "/nodes/sop/group"}, "."]}, {"body": [{"indent": 8, "type": "para", "text": ["This creates a new group named ", {"text": ["invalid_poly_grp"], "type": "code"}, " which contains all the polygons ", {"text": ["not"], "type": "em"}, " in ", {"text": ["valid_poly_grp"], "type": "code"}, "."]}], "indent": 4, "blevel": 6, "type": "ord", "text": ["In the Group Geometry node, click the ", {"text": ["Combine"], "type": "ui"}, " tab. In the ", {"text": ["Group"], "type": "ui"}, " parameter, set the left side to ", {"text": ["invalid_poly_grp"], "type": "code"}, ", click the ", {"text": "", "fullpath": "/nodes/sop/BUTTONS/not_equal", "scheme": "Smallicon", "type": "link", "value": "BUTTONS/not_equal"}, " Not Equal button, and set the right side to ", {"text": ["valid_poly_grp"], "type": "code"}, "."]}, {"indent": 4, "blevel": 6, "type": "ord", "text": ["To color the polygons in ", {"text": ["invalid_poly_grp"], "type": "code"}, ", right click the output of the Group Geometry and choose ", {"text": ["Color"], "fullpath": "/nodes/sop/color", "scheme": "Node", "type": "link", "value": "/nodes/sop/color"}, "."]}, {"indent": 4, "blevel": 6, "type": "ord", "text": ["In the Color node, set ", {"text": ["Group"], "type": "ui"}, " to ", {"text": ["invalid_poly_grp"], "type": "code"}, ", set the ", {"text": ["Class"], "type": "ui"}, " to \"Primitive\" and set the ", {"text": ["Color"], "type": "ui"}, " to red."]}, {"indent": 4, "blevel": 6, "type": "ord", "text": ["Click the ", {"text": ["display flag"], "fullpath": "/nodes/sop/index", "scheme": null, "type": "link", "value": "/nodes/sop/"}, " on the Color node."]}], "container": true, "type": "ord_group"}], "indent": 0, "role": "item", "type": "task", "text": ["Color invalid polygons red in the viewport"]}], "container": true, "role": "item_group", "type": "task_group"}, {"body": [{"body": [{"indent": 4, "type": "para", "text": ["You can create a branch in the node network with a ", {"text": ["Switch node"], "fullpath": "/nodes/sop/switch", "scheme": "Node", "type": "link", "value": "/nodes/sop/switch"}, ", or use the bypass flag on the Color node, to switch between the normal polygon colors and the invalid polygon coloring."]}], "indent": 0, "role": "item", "type": "tip"}], "container": true, "role": "item_group", "type": "tip_group"}], "indent": 0, "level": 2, "text": ["Visualizing problems"], "container": true, "type": "h", "id": "visualize"}, {"body": [{"body": [{"body": [{"indent": 4, "type": "para", "text": ["The maximum passes allowed over all of the algorithms repairing the geometry in this SOP. Using multiple passes lets the node repair possible problems created by fixing another problem."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Max Passes"]}, {"body": [{"indent": 4, "type": "para", "text": ["Used in the Globally/Locally Small Area repairs to randomize the order in which polygons are repaired. This makes the resulting geometry more uniform. You can try changing it to get a slightly different layout."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Random Seed"]}], "container": true, "role": "item_group", "type": "parameters_item_group"}, {"body": [{"body": [{"body": [{"indent": 4, "type": "para", "text": ["Polygons with overlapping or \"degenerate\" vertices. This problem is difficult to detect and fix manually, but it helps other algorithms (dynamic solvers and other operations in this node) to run smoothly."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Ill-Formed"]}, {"body": [{"body": [{"indent": 8, "type": "para", "text": ["When this node repairs polygons with five or more edges, it picks the most uniform quadrilaterals and triangles to divide the polygons."]}], "indent": 4, "type": "para", "text": ["Polygons with five or more edges. Cloth simulation works better with quads or triangles. This fix can also be useful for working with modeling formats and software that do not support N-sided polygons."]}, {"body": [{"body": [{"indent": 8, "type": "para", "text": ["You should always use this SOP instead of the ", {"text": ["Divide SOP"], "fullpath": "/nodes/sop/divide", "scheme": "Node", "type": "link", "value": "/nodes/sop/divide"}, " when cleaning up geometry for use as cloth simulation objects."]}], "indent": 4, "role": "item", "type": "note"}], "container": true, "role": "item_group", "type": "note_group"}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["5+ Edges"]}, {"body": [{"indent": 8, "type": "para", "text": ["After marking or repairing ", {"text": ["5+ Edges"], "type": "ui"}, " polygons, there may still be non-convex quadrilaterals."]}, {"indent": 8, "type": "para", "text": ["When this node repairs non-convex quadrilaterals, it triangulates them in the best way for use with the cloth solver."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Non-Convex"]}, {"body": [{"indent": 4, "type": "para", "text": ["Different polygons with the same vertices. Repairing removes all but one of the overlapping polygons."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Overlapping"]}, {"body": [{"indent": 4, "type": "para", "text": ["When this option is on, overlapping polygons are both deleted.\n    This is useful when the overlap comes from two objects fusing\n    along an edge. When this option is off, the first overlapping\n    polygon is kept and the second polygon is deleted."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Pair Overlaps"]}, {"body": [{"indent": 8, "type": "para", "text": ["Polygons that overlap/intersect other polygons or themselves. Repairing removes the polygons completely."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Self-intersecting"]}, {"body": [{"indent": 8, "type": "para", "text": ["A virtual thickness added to geometry objects when checking for intersections as specified above. Objects that are closer to each other than this will be detected as intersecting."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Thickness"]}, {"body": [{"indent": 8, "type": "para", "text": ["Polygons with small areas compared with the ", {"text": ["Global Area Threshold"], "type": "ui"}, ". Repairing shrinks these polygons to a point."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Globally Small Areas"]}, {"body": [{"indent": 4, "type": "para", "text": ["A value between 0 (no area) and 1 (the circumference of a bounding sphere containing the input geometry). Polygons with an area smaller than this threshold are marked/repaired."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Global Area Threshold"]}, {"body": [{"indent": 8, "type": "para", "text": ["Polygons with small areas relative to their neighbors (polygons with a shared edge). Repairing shrinks these polygons to a point."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Locally Small Areas"]}, {"body": [{"indent": 4, "type": "para", "text": ["A ratio value of \"smaller polygon area divided by larger polygon area\". Polygons with smaller areas than this relative to their neighbors are marked/repaired. For example, a value of ", {"text": ["0.1"], "type": "code"}, " would repair any polygons less than one-tenth the size of their neighbors."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Local Area Threshold"]}, {"body": [{"indent": 8, "type": "para", "text": ["Polygons whose area is not uniformly distributed (thin or awkwardly shaped), as set by the ", {"text": ["Uniformity threshold"], "type": "ui"}, "."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Non-Uniform Polygons"]}, {"body": [{"indent": 4, "type": "para", "text": ["A value between 1 (a circle) and zero (totally non-uniform, like a very thin rectangle or a polygon with a small area but large perimeter). Polygons with uniformity lower than this are marked/repaired."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Uniformity Threshold"]}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Primitives"], "container": true, "type": "h", "id": null}, {"body": [{"indent": 0, "type": "para", "text": ["Setting the edge-related parameters to \"Mark\" will mark the polygons containing the invalid edges."]}, {"body": [{"body": [{"indent": 8, "type": "para", "text": ["Edges with a short length compared to the ", {"text": ["Global Edge Threshold"], "type": "ui"}, ". Repairing shrinks these edges to the midpoint of the edge."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Globally Small Edges"]}, {"body": [{"indent": 4, "type": "para", "text": ["A value between 0 (zero length) and 1 (the diameter of a bounding sphere containing the input geometry). Edges shorter than this threshold are marked/repaired."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Global Edge Threshold"]}, {"body": [{"indent": 4, "type": "para", "text": ["Edges with a short length, compared to the edges of neighbors (polygons with a shared edge). Repairing shrinks these edges to the midpoint of the edge."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Locally Small Edges"]}, {"body": [{"indent": 4, "type": "para", "text": ["The minimum allowed edge-to-edge ratio. Smaller values allow ", {"text": ["larger"], "type": "em"}, " edge length differences."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Local Edge Threshold"]}, {"body": [{"indent": 8, "type": "para", "text": ["Points that don\u2019t belong to a polygon. Repairing removes these points completely."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Disconnected Points"]}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Edges & Points"], "container": true, "type": "h", "id": null}, {"body": [{"body": [{"body": [{"body": [{"body": [{"indent": 16, "type": "para", "text": ["Marks points whose incident polygons form non-manifold topology around them, i.e. their infinitesimal neighborhood restricted to polygons does not have topology of either a disc or a half-disc. "]}], "indent": 8, "type": "dt", "text": ["Mark"]}, {"body": [{"indent": 16, "type": "para", "text": ["Enforces all points to become manifold points by minimally duplicating points and reassigning polygons incident to each point to various duplicates of it. "]}], "indent": 8, "type": "dt", "text": ["Repair"]}], "container": true, "type": "dt_group"}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Non-Manifold Points"]}, {"body": [{"indent": 8, "type": "para", "text": ["If this checkbox is turned on, maximal manifold polygon patches are detected without taking the given winding of the polygons into effect. A maximal manifold patch is essentially a proper piece of surface with either no boundary or a boundary composed of edges that are incident to either 1 or 3+ polygons."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Ignore Winding of Input Polygons"]}, {"body": [{"indent": 8, "type": "para", "text": ["When repairing non-manifold points, the repair procedure may have to make decisions on which pairs of polygons incident to the same edges should be paired together to locally form surfaces. If this option is set, preference is placed over choosing pairs which are closer to being coplanar (small normal difference). Otherwise, pairs that form sharp dihedral angles (large normal difference) are connected first. "]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Prefer Larger Angles Between Neighboring Polygons"]}, {"body": [{"indent": 8, "type": "para", "text": ["When this checkbox is turned on, maximal manifold patches of the input geometry are colored randomly. Visualizing these patches can help you see disconnects between polygons that are expected to be neighbors on the same patch of surface but fail to do so due to various reasons ranging from inconsistent winding (unless ", {"text": ["Ignore Winding of Input Polygons"], "type": "ui"}, " is selected) to non-manifold topology at boundary points that may be hard to recognize because of degenerate geometry."]}, {"body": [{"body": [{"indent": 16, "type": "para", "text": ["This option is overridden if any of the visualization options are selected in the ", {"text": ["Visualize"], "type": "ui"}, " tab."]}], "indent": 8, "role": "item", "type": "note"}], "container": true, "role": "item_group", "type": "note_group"}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Visualize Maximal Manifold Patches"]}, {"body": [{"indent": 8, "type": "para", "text": ["If this checkbox is turned on, a primitive attribute named ", {"text": ["manifoldnumber"], "type": "code"}, " is created that indicates the manifold patch to which each polygons belongs. The generated manifold numbers are in the range of ", {"text": ["0"], "type": "code"}, " to ", {"text": ["m - 1"], "type": "code"}, ", where m is the number of manifold patches. Non-polygon primtives (as well as non-closed polygons) are given a manifold number of -1."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Create Manifold Number Attribute"]}, {"body": [{"indent": 8, "type": "para", "text": ["If this checkbox is turned on, maximal manifold patches are calculated ignoring the winding of the polygons and then the windings of polygons in the same patch are made consistent with the dominant winding of that patch. "]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Correct Winding of Polygons to Majority of their Manifold Patch"]}, {"body": [{"indent": 8, "type": "para", "text": ["If ", {"text": ["Repair"], "type": "ui"}, " is chosen as the action on ", {"text": ["Non-Manifold Points"], "type": "ui"}, ", then this option deletes all maximal manifold patches that have fewer polygons than a desired threshold. This is useful since often repairing non-manifold points may detach small parts of the geometry that prevent the formation of clean manifold patches from the reset. These detached geometry make up manifold patches themselves, but are often composed of very few (often one or two) polygons and are generally unwanted."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Delete Small Manifold Patches"]}, {"body": [{"indent": 8, "type": "para", "text": ["Specifies the threshold used in deleting small manifold patches. Any manifold patch with up to this many polygons will be deleted. "]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Primitive Threshold"]}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Topology"], "container": true, "type": "h", "id": null}, {"body": [{"indent": 0, "type": "para", "text": ["The parameters on this tab let you set the names of the attributes created by\nthis node, and optionally create groups."]}, {"body": [{"body": [{"indent": 4, "type": "para", "text": ["The name of the primitive attribute used to mark polygons. The default is ", {"text": ["valid_poly"], "type": "code"}, ". Valid polygons will have this attribute set to ", {"text": ["1"], "type": "code"}, ". Marked invalid polygons will have it set to ", {"text": ["0"], "type": "code"}, "."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Valid Polygons"]}, {"body": [{"indent": 4, "type": "para", "text": ["The name of the primitive attribute used to indicate repaired polygons. The default is ", {"text": ["repaired_poly"], "type": "code"}, ". Polygons edited by this node will have this attribute set to ", {"text": ["1"], "type": "code"}, ". This is a subset of the valid polygons."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Repaired Polygons"]}, {"body": [{"indent": 8, "type": "para", "text": ["The name of the point attribute used to mark points. The default is ", {"text": ["valid_pt"], "type": "code"}, ". Valid points will have this attribute set to ", {"text": ["1"], "type": "code"}, ". Marked invalid points will have it set to ", {"text": ["0"], "type": "code"}, "."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Valid Points"]}, {"body": [{"indent": 8, "type": "para", "text": ["The name of the primitive attribute used to indicate modified points. The default is ", {"text": ["repaired_pt"], "type": "code"}, ". Points edited by this node will have this attribute set to ", {"text": ["1"], "type": "code"}, ". This is a subset of the valid points."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Modified Points"]}, {"body": [{"indent": 8, "type": "para", "text": ["Creates ", {"text": ["groups"], "fullpath": "/model/groups", "scheme": null, "type": "link", "value": "/model/groups"}, " containing the polygons with a particular attribute set to ", {"text": ["1"], "type": "code"}, ". The names of the groups are the names of the corresponding attributes with ", {"text": ["_grp"], "type": "code"}, " added. For example, all polygons with ", {"text": ["valid_poly"], "type": "code"}, " set to ", {"text": ["1"], "type": "code"}, " will be in a group named ", {"text": ["valid_poly_grp"], "type": "code"}, "."]}, {"indent": 8, "type": "para", "text": ["To invert a group, use the ", {"text": ["Group Geometry node"], "fullpath": "/nodes/sop/group", "scheme": "Node", "type": "link", "value": "/nodes/sop/group"}, " with the ", {"text": ["Combine"], "type": "ui"}, " tab. See ", {"fragment": "#visualize", "text": ["visualizing problems"], "value": "#visualize", "fullpath": "/nodes/sop/polydoctor#visualize", "scheme": null, "type": "link"}, " above."]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Create a group for each attribute"]}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Attributes"], "container": true, "type": "h", "id": null}, {"body": [{"indent": 0, "type": "para", "text": ["Options in this tab can help visualize points and polygons that are marked and repaired in other tabs. "]}, {"body": [{"body": [{"indent": 8, "type": "para", "text": ["If selected, the marked points are painted in the chosen color. "]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Invalid Points"]}, {"body": [{"indent": 8, "type": "para", "text": ["If selected, repaired points are painted in the chosen color. "]}, {"body": [{"body": [{"indent": 16, "type": "para", "text": ["If a point is both marked and repaired, it takes the color selected for repaired points. "]}], "indent": 8, "role": "item", "type": "note"}], "container": true, "role": "item_group", "type": "note_group"}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Repaired Points"]}, {"body": [{"indent": 8, "type": "para", "text": ["If selected, marked polygons are displayed in the chosen color. "]}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Invalid Polygons"]}, {"body": [{"indent": 8, "type": "para", "text": ["If selected, repaired polygons are displayed in the chosen color. "]}, {"body": [{"body": [{"indent": 16, "type": "para", "text": ["Visualizing points takes precedence over visualizing polygons. Therefore, if any of the \"Invalid Points\" and \"Repaired Points\" options are chosen in this tab, the corresponding selections for polygons are ignored. "]}], "indent": 8, "role": "item", "type": "note"}], "container": true, "role": "item_group", "type": "note_group"}], "indent": 0, "role": "item", "type": "parameters_item", "text": ["Repaired Polygons"]}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Visualize"], "container": true, "type": "h", "id": null}], "indent": 0, "level": 1, "text": "Parameters", "role": "section", "container": true, "type": "parameters_section", "id": "parameters"}, {"body": [{"body": [{"indent": 0, "blevel": 2, "type": "bullet", "text": [{"text": "", "fullpath": "/nodes/sop/facet", "scheme": "Node", "type": "link", "value": "/nodes/sop/facet"}]}, {"indent": 0, "blevel": 2, "type": "bullet", "text": [{"text": "", "fullpath": "/nodes/sop/divide", "scheme": "Node", "type": "link", "value": "/nodes/sop/divide"}]}, {"indent": 0, "blevel": 2, "type": "bullet", "text": [{"text": "", "fullpath": "/nodes/sop/delete", "scheme": "Node", "type": "link", "value": "/nodes/sop/delete"}]}], "container": true, "type": "bullet_group"}], "indent": 0, "level": 1, "text": "Related", "role": "section", "container": true, "type": "related_section", "id": "related"}], "summary": ["Helps repair invalid polygonal geometry, such as for cloth simulation."], "type": "root", "attrs": {"version": null, "tags": "cloth", "namespace": null, "internal": "polydoctor", "context": "sop", "type": "node", "icon": "SOP/polydoctor"}, "title": ["PolyDoctor"]}